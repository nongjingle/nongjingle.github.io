---
title: "373.Find K Pairs with Smallest Sums"
categories: [leetcode]
tags: [leetcode]
---

## 373. Find K Pairs with Smallest Sums

[problem link](https://leetcode.com/problems/find-k-pairs-with-smallest-sums/)

### C++
```c++
#include <queue>
#include <vector>

class Solution {
 public:
  std::vector<std::vector<int>> kSmallestPairs(std::vector<int>& nums1,
                                               std::vector<int>& nums2, int k) {
    auto compare = [](std::vector<int>& pair0, std::vector<int>& pair1) {
      return (pair0[0] + pair0[1]) > (pair1[0] + pair1[1]);
    };

    std::priority_queue<std::vector<int>, std::vector<std::vector<int>>,
                        decltype(compare)>
        pq(compare);

    for (size_t i = 0; i < nums1.size(); i++) {
      pq.push({nums1[i], nums2[0], 0});
    }

    std::vector<std::vector<int>> result;
    while (!pq.empty() && k > 0) {
      std::vector<int> node = pq.top();
      pq.pop();
      k--;
      result.push_back({node[0], node[1]});
      int idx = node[2] + 1;
      if (idx < nums2.size()) pq.push({node[0], nums2[idx], idx});
    }

    return result;
  }
};
```

### Java
```java
import java.util.List;
import java.util.PriorityQueue;
import java.util.ArrayList;

class Solution {
    public List<List<Integer>> kSmallestPairs(int[] nums1, int[] nums2, int k) {
        List<List<Integer>> result = new ArrayList<>();

        PriorityQueue<int[]> pq = new PriorityQueue<>((pair0, pair1) -> {
            return (pair0[0] + pair0[1]) - (pair1[0] + pair1[1]);
        });

        for (int i = 0; i < nums1.length; i++) {
            pq.add(new int[] { nums1[i], nums2[0], 0 });
        }

        while (!pq.isEmpty() && k > 0) {
            int[] node = pq.poll();
            k -= 1;
            int idx = node[2] + 1;
            if (idx < nums2.length)
                pq.add(new int[] { node[0], nums2[idx], idx });
            result.add(List.of(node[0], node[1]));
        }

        return result;
    }
}
```

### Python
```python
import heapq
from typing import List
from queue import PriorityQueue


class Solution:
    def kSmallestPairs(self, nums1: List[int], nums2: List[int], k: int) -> List[List[int]]:
        pq = PriorityQueue()

        for i in range(len(nums1)):
            pq.put((nums1[i]+nums2[0], nums1[i], nums2[0], 0))

        result = []
        while not pq.empty() and k > 0:
            _, num1, num2, idx = pq.get()
            k -= 1
            idx += 1
            if idx < len(nums2):
                pq.put((num1+nums2[idx], num1, nums2[idx], idx))

            result.append([num1, num2])

        return result
```
